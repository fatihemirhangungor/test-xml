using System;
using DocumentFormat.OpenXml.Packaging;
using DocumentFormat.OpenXml.Spreadsheet;

class Program
{
    static void Main(string[] args)
    {
        string filePath = @"path_to_your_excel_file.xlsx";

        // Open the Excel file
        using (SpreadsheetDocument spreadsheet = SpreadsheetDocument.Open(filePath, true))
        {
            // Get the first worksheet
            WorkbookPart workbookPart = spreadsheet.WorkbookPart;
            WorksheetPart worksheetPart = workbookPart.WorksheetParts.First();
            SheetData sheetData = worksheetPart.Worksheet.GetFirstChild<SheetData>();

            foreach (Row row in sheetData.Elements<Row>())
            {
                foreach (Cell cell in row.Elements<Cell>())
                {
                    // Read the cell value
                    string cellValue = GetCellValue(workbookPart, cell);

                    // Check if the cell format is numeric
                    if (cell.DataType == null || cell.DataType.Value == CellValues.Number)
                    {
                        // Convert the value to text
                        cell.DataType = CellValues.String;
                        cell.CellValue = new CellValue(cellValue);
                    }

                    // Print the value
                    Console.WriteLine(cell.CellValue?.Text);
                }
            }
        }
    }

    static string GetCellValue(WorkbookPart workbookPart, Cell cell)
    {
        string value = cell.CellValue?.Text;

        if (cell.DataType != null && cell.DataType.Value == CellValues.SharedString)
        {
            // Retrieve the shared string value
            var stringTable = workbookPart.GetPartsOfType<SharedStringTablePart>().FirstOrDefault();
            value = stringTable?.SharedStringTable.ElementAt(int.Parse(value)).InnerText;
        }

        return value;
    }
}
